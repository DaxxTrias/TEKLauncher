namespace TEKLauncher.Utils;

/// <summary>Optimized SHA1 algorithm implementation.</summary>
static class SHA1
{
    /// <summary>Computes SHA-1 hash for specified stream.</summary>
    /// <param name="stream">Stream to compute the hash for; it will be read until end of stream is reached.</param>
    /// <param name="hash">Buffer that will receive SHA-1 hash value.</param>
    public static void ComputeHash(Stream stream, Span<byte> hash)
    {
        uint h0 = 0x67452301, h1 = 0xEFCDAB89, h2 = 0x98BADCFE, h3 = 0x10325476, h4 = 0xC3D2E1F0;
        uint c0, c1, c2, c3, c4;
        uint temp;
        long totalBytesRead = 0;
        Span<byte> buffer = stackalloc byte[524288];
        Span<uint> block = stackalloc uint[16];
        int bytesRead;
        for (;;)
        {
            bytesRead = stream.Read(buffer);
            if (bytesRead == 0)
                break;
            totalBytesRead += bytesRead;
            for (int i = 0; i < bytesRead >> 6; i++)
            {
                var blockBuffer = buffer.Slice(i << 6, 64);
                block[0] = ((uint)blockBuffer[3] & 0xFF) | ((uint)blockBuffer[2] & 0xFF) << 8 | ((uint)blockBuffer[1] & 0xFF) << 16 | ((uint)blockBuffer[0] & 0xFF) << 24;
                block[1] = ((uint)blockBuffer[7] & 0xFF) | ((uint)blockBuffer[6] & 0xFF) << 8 | ((uint)blockBuffer[5] & 0xFF) << 16 | ((uint)blockBuffer[4] & 0xFF) << 24;
                block[2] = ((uint)blockBuffer[11] & 0xFF) | ((uint)blockBuffer[10] & 0xFF) << 8 | ((uint)blockBuffer[9] & 0xFF) << 16 | ((uint)blockBuffer[8] & 0xFF) << 24;
                block[3] = ((uint)blockBuffer[15] & 0xFF) | ((uint)blockBuffer[14] & 0xFF) << 8 | ((uint)blockBuffer[13] & 0xFF) << 16 | ((uint)blockBuffer[12] & 0xFF) << 24;
                block[4] = ((uint)blockBuffer[19] & 0xFF) | ((uint)blockBuffer[18] & 0xFF) << 8 | ((uint)blockBuffer[17] & 0xFF) << 16 | ((uint)blockBuffer[16] & 0xFF) << 24;
                block[5] = ((uint)blockBuffer[23] & 0xFF) | ((uint)blockBuffer[22] & 0xFF) << 8 | ((uint)blockBuffer[21] & 0xFF) << 16 | ((uint)blockBuffer[20] & 0xFF) << 24;
                block[6] = ((uint)blockBuffer[27] & 0xFF) | ((uint)blockBuffer[26] & 0xFF) << 8 | ((uint)blockBuffer[25] & 0xFF) << 16 | ((uint)blockBuffer[24] & 0xFF) << 24;
                block[7] = ((uint)blockBuffer[31] & 0xFF) | ((uint)blockBuffer[30] & 0xFF) << 8 | ((uint)blockBuffer[29] & 0xFF) << 16 | ((uint)blockBuffer[28] & 0xFF) << 24;
                block[8] = ((uint)blockBuffer[35] & 0xFF) | ((uint)blockBuffer[34] & 0xFF) << 8 | ((uint)blockBuffer[33] & 0xFF) << 16 | ((uint)blockBuffer[32] & 0xFF) << 24;
                block[9] = ((uint)blockBuffer[39] & 0xFF) | ((uint)blockBuffer[38] & 0xFF) << 8 | ((uint)blockBuffer[37] & 0xFF) << 16 | ((uint)blockBuffer[36] & 0xFF) << 24;
                block[10] = ((uint)blockBuffer[43] & 0xFF) | ((uint)blockBuffer[42] & 0xFF) << 8 | ((uint)blockBuffer[41] & 0xFF) << 16 | ((uint)blockBuffer[40] & 0xFF) << 24;
                block[11] = ((uint)blockBuffer[47] & 0xFF) | ((uint)blockBuffer[46] & 0xFF) << 8 | ((uint)blockBuffer[45] & 0xFF) << 16 | ((uint)blockBuffer[44] & 0xFF) << 24;
                block[12] = ((uint)blockBuffer[51] & 0xFF) | ((uint)blockBuffer[50] & 0xFF) << 8 | ((uint)blockBuffer[49] & 0xFF) << 16 | ((uint)blockBuffer[48] & 0xFF) << 24;
                block[13] = ((uint)blockBuffer[55] & 0xFF) | ((uint)blockBuffer[54] & 0xFF) << 8 | ((uint)blockBuffer[53] & 0xFF) << 16 | ((uint)blockBuffer[52] & 0xFF) << 24;
                block[14] = ((uint)blockBuffer[59] & 0xFF) | ((uint)blockBuffer[58] & 0xFF) << 8 | ((uint)blockBuffer[57] & 0xFF) << 16 | ((uint)blockBuffer[56] & 0xFF) << 24;
                block[15] = ((uint)blockBuffer[63] & 0xFF) | ((uint)blockBuffer[62] & 0xFF) << 8 | ((uint)blockBuffer[61] & 0xFF) << 16 | ((uint)blockBuffer[60] & 0xFF) << 24;
                c0 = h0;
                c1 = h1;
                c2 = h2;
                c3 = h3;
                c4 = h4;
                c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[0] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[1] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[2] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[3] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[4] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[5] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[6] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[7] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[8] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[9] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[10] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[11] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[12] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[13] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[14] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[15] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[13] ^ block[8] ^ block[2] ^ block[0];
                block[0] = (temp << 1) | (temp >> 31);
                c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[0] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[14] ^ block[9] ^ block[3] ^ block[1];
                block[1] = (temp << 1) | (temp >> 31);
                c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[1] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[15] ^ block[10] ^ block[4] ^ block[2];
                block[2] = (temp << 1) | (temp >> 31);
                c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[2] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[0] ^ block[11] ^ block[5] ^ block[3];
                block[3] = (temp << 1) | (temp >> 31);
                c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[3] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[1] ^ block[12] ^ block[6] ^ block[4];
                block[4] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[4] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[2] ^ block[13] ^ block[7] ^ block[5];
                block[5] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[5] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[3] ^ block[14] ^ block[8] ^ block[6];
                block[6] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[6] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[4] ^ block[15] ^ block[9] ^ block[7];
                block[7] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[7] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[5] ^ block[0] ^ block[10] ^ block[8];
                block[8] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[8] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[6] ^ block[1] ^ block[11] ^ block[9];
                block[9] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[9] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[7] ^ block[2] ^ block[12] ^ block[10];
                block[10] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[10] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[8] ^ block[3] ^ block[13] ^ block[11];
                block[11] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[11] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[9] ^ block[4] ^ block[14] ^ block[12];
                block[12] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[12] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[10] ^ block[5] ^ block[15] ^ block[13];
                block[13] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[13] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[11] ^ block[6] ^ block[0] ^ block[14];
                block[14] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[14] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[12] ^ block[7] ^ block[1] ^ block[15];
                block[15] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[15] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[13] ^ block[8] ^ block[2] ^ block[0];
                block[0] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[0] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[14] ^ block[9] ^ block[3] ^ block[1];
                block[1] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[1] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[15] ^ block[10] ^ block[4] ^ block[2];
                block[2] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[2] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[0] ^ block[11] ^ block[5] ^ block[3];
                block[3] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[3] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[1] ^ block[12] ^ block[6] ^ block[4];
                block[4] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[4] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[2] ^ block[13] ^ block[7] ^ block[5];
                block[5] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[5] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[3] ^ block[14] ^ block[8] ^ block[6];
                block[6] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[6] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[4] ^ block[15] ^ block[9] ^ block[7];
                block[7] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[7] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[5] ^ block[0] ^ block[10] ^ block[8];
                block[8] = (temp << 1) | (temp >> 31);
                c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[8] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[6] ^ block[1] ^ block[11] ^ block[9];
                block[9] = (temp << 1) | (temp >> 31);
                c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[9] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[7] ^ block[2] ^ block[12] ^ block[10];
                block[10] = (temp << 1) | (temp >> 31);
                c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[10] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[8] ^ block[3] ^ block[13] ^ block[11];
                block[11] = (temp << 1) | (temp >> 31);
                c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[11] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[9] ^ block[4] ^ block[14] ^ block[12];
                block[12] = (temp << 1) | (temp >> 31);
                c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[12] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[10] ^ block[5] ^ block[15] ^ block[13];
                block[13] = (temp << 1) | (temp >> 31);
                c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[13] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[11] ^ block[6] ^ block[0] ^ block[14];
                block[14] = (temp << 1) | (temp >> 31);
                c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[14] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[12] ^ block[7] ^ block[1] ^ block[15];
                block[15] = (temp << 1) | (temp >> 31);
                c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[15] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[13] ^ block[8] ^ block[2] ^ block[0];
                block[0] = (temp << 1) | (temp >> 31);
                c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[0] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[14] ^ block[9] ^ block[3] ^ block[1];
                block[1] = (temp << 1) | (temp >> 31);
                c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[1] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[15] ^ block[10] ^ block[4] ^ block[2];
                block[2] = (temp << 1) | (temp >> 31);
                c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[2] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[0] ^ block[11] ^ block[5] ^ block[3];
                block[3] = (temp << 1) | (temp >> 31);
                c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[3] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[1] ^ block[12] ^ block[6] ^ block[4];
                block[4] = (temp << 1) | (temp >> 31);
                c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[4] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[2] ^ block[13] ^ block[7] ^ block[5];
                block[5] = (temp << 1) | (temp >> 31);
                c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[5] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[3] ^ block[14] ^ block[8] ^ block[6];
                block[6] = (temp << 1) | (temp >> 31);
                c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[6] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[4] ^ block[15] ^ block[9] ^ block[7];
                block[7] = (temp << 1) | (temp >> 31);
                c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[7] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[5] ^ block[0] ^ block[10] ^ block[8];
                block[8] = (temp << 1) | (temp >> 31);
                c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[8] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[6] ^ block[1] ^ block[11] ^ block[9];
                block[9] = (temp << 1) | (temp >> 31);
                c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[9] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[7] ^ block[2] ^ block[12] ^ block[10];
                block[10] = (temp << 1) | (temp >> 31);
                c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[10] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[8] ^ block[3] ^ block[13] ^ block[11];
                block[11] = (temp << 1) | (temp >> 31);
                c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[11] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[9] ^ block[4] ^ block[14] ^ block[12];
                block[12] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[12] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[10] ^ block[5] ^ block[15] ^ block[13];
                block[13] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[13] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[11] ^ block[6] ^ block[0] ^ block[14];
                block[14] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[14] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[12] ^ block[7] ^ block[1] ^ block[15];
                block[15] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[15] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[13] ^ block[8] ^ block[2] ^ block[0];
                block[0] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[0] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[14] ^ block[9] ^ block[3] ^ block[1];
                block[1] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[1] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[15] ^ block[10] ^ block[4] ^ block[2];
                block[2] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[2] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[0] ^ block[11] ^ block[5] ^ block[3];
                block[3] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[3] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[1] ^ block[12] ^ block[6] ^ block[4];
                block[4] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[4] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[2] ^ block[13] ^ block[7] ^ block[5];
                block[5] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[5] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[3] ^ block[14] ^ block[8] ^ block[6];
                block[6] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[6] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[4] ^ block[15] ^ block[9] ^ block[7];
                block[7] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[7] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[5] ^ block[0] ^ block[10] ^ block[8];
                block[8] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[8] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[6] ^ block[1] ^ block[11] ^ block[9];
                block[9] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[9] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[7] ^ block[2] ^ block[12] ^ block[10];
                block[10] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[10] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[8] ^ block[3] ^ block[13] ^ block[11];
                block[11] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[11] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[9] ^ block[4] ^ block[14] ^ block[12];
                block[12] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[12] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[10] ^ block[5] ^ block[15] ^ block[13];
                block[13] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[13] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[11] ^ block[6] ^ block[0] ^ block[14];
                block[14] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[14] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[12] ^ block[7] ^ block[1] ^ block[15];
                block[15] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[15] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                h0 += c0;
                h1 += c1;
                h2 += c2;
                h3 += c3;
                h4 += c4;
            }
            int remainder = bytesRead & 63;
            if (remainder > 0)
            {
                buffer = buffer[(bytesRead - remainder)..];
                bytesRead = remainder;
                break;
            }
        }
        buffer[bytesRead++] = 0x80;
        bool transform = bytesRead > 56;
        while (bytesRead < 64)
            buffer[bytesRead++] = 0;
        block[0] = ((uint)buffer[3] & 0xFF) | ((uint)buffer[2] & 0xFF) << 8 | ((uint)buffer[1] & 0xFF) << 16 | ((uint)buffer[0] & 0xFF) << 24;
        block[1] = ((uint)buffer[7] & 0xFF) | ((uint)buffer[6] & 0xFF) << 8 | ((uint)buffer[5] & 0xFF) << 16 | ((uint)buffer[4] & 0xFF) << 24;
        block[2] = ((uint)buffer[11] & 0xFF) | ((uint)buffer[10] & 0xFF) << 8 | ((uint)buffer[9] & 0xFF) << 16 | ((uint)buffer[8] & 0xFF) << 24;
        block[3] = ((uint)buffer[15] & 0xFF) | ((uint)buffer[14] & 0xFF) << 8 | ((uint)buffer[13] & 0xFF) << 16 | ((uint)buffer[12] & 0xFF) << 24;
        block[4] = ((uint)buffer[19] & 0xFF) | ((uint)buffer[18] & 0xFF) << 8 | ((uint)buffer[17] & 0xFF) << 16 | ((uint)buffer[16] & 0xFF) << 24;
        block[5] = ((uint)buffer[23] & 0xFF) | ((uint)buffer[22] & 0xFF) << 8 | ((uint)buffer[21] & 0xFF) << 16 | ((uint)buffer[20] & 0xFF) << 24;
        block[6] = ((uint)buffer[27] & 0xFF) | ((uint)buffer[26] & 0xFF) << 8 | ((uint)buffer[25] & 0xFF) << 16 | ((uint)buffer[24] & 0xFF) << 24;
        block[7] = ((uint)buffer[31] & 0xFF) | ((uint)buffer[30] & 0xFF) << 8 | ((uint)buffer[29] & 0xFF) << 16 | ((uint)buffer[28] & 0xFF) << 24;
        block[8] = ((uint)buffer[35] & 0xFF) | ((uint)buffer[34] & 0xFF) << 8 | ((uint)buffer[33] & 0xFF) << 16 | ((uint)buffer[32] & 0xFF) << 24;
        block[9] = ((uint)buffer[39] & 0xFF) | ((uint)buffer[38] & 0xFF) << 8 | ((uint)buffer[37] & 0xFF) << 16 | ((uint)buffer[36] & 0xFF) << 24;
        block[10] = ((uint)buffer[43] & 0xFF) | ((uint)buffer[42] & 0xFF) << 8 | ((uint)buffer[41] & 0xFF) << 16 | ((uint)buffer[40] & 0xFF) << 24;
        block[11] = ((uint)buffer[47] & 0xFF) | ((uint)buffer[46] & 0xFF) << 8 | ((uint)buffer[45] & 0xFF) << 16 | ((uint)buffer[44] & 0xFF) << 24;
        block[12] = ((uint)buffer[51] & 0xFF) | ((uint)buffer[50] & 0xFF) << 8 | ((uint)buffer[49] & 0xFF) << 16 | ((uint)buffer[48] & 0xFF) << 24;
        block[13] = ((uint)buffer[55] & 0xFF) | ((uint)buffer[54] & 0xFF) << 8 | ((uint)buffer[53] & 0xFF) << 16 | ((uint)buffer[52] & 0xFF) << 24;
        block[14] = ((uint)buffer[59] & 0xFF) | ((uint)buffer[58] & 0xFF) << 8 | ((uint)buffer[57] & 0xFF) << 16 | ((uint)buffer[56] & 0xFF) << 24;
        block[15] = ((uint)buffer[63] & 0xFF) | ((uint)buffer[62] & 0xFF) << 8 | ((uint)buffer[61] & 0xFF) << 16 | ((uint)buffer[60] & 0xFF) << 24;
        if (transform)
        {
            c0 = h0;
            c1 = h1;
            c2 = h2;
            c3 = h3;
            c4 = h4;
            c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[0] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[1] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[2] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[3] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[4] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[5] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[6] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[7] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[8] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[9] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[10] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[11] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[12] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[13] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[14] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[15] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[13] ^ block[8] ^ block[2] ^ block[0];
            block[0] = (temp << 1) | (temp >> 31);
            c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[0] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[14] ^ block[9] ^ block[3] ^ block[1];
            block[1] = (temp << 1) | (temp >> 31);
            c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[1] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[15] ^ block[10] ^ block[4] ^ block[2];
            block[2] = (temp << 1) | (temp >> 31);
            c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[2] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[0] ^ block[11] ^ block[5] ^ block[3];
            block[3] = (temp << 1) | (temp >> 31);
            c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[3] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[1] ^ block[12] ^ block[6] ^ block[4];
            block[4] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[4] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[2] ^ block[13] ^ block[7] ^ block[5];
            block[5] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[5] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[3] ^ block[14] ^ block[8] ^ block[6];
            block[6] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[6] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[4] ^ block[15] ^ block[9] ^ block[7];
            block[7] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[7] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[5] ^ block[0] ^ block[10] ^ block[8];
            block[8] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[8] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[6] ^ block[1] ^ block[11] ^ block[9];
            block[9] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[9] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[7] ^ block[2] ^ block[12] ^ block[10];
            block[10] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[10] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[8] ^ block[3] ^ block[13] ^ block[11];
            block[11] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[11] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[9] ^ block[4] ^ block[14] ^ block[12];
            block[12] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[12] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[10] ^ block[5] ^ block[15] ^ block[13];
            block[13] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[13] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[11] ^ block[6] ^ block[0] ^ block[14];
            block[14] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[14] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[12] ^ block[7] ^ block[1] ^ block[15];
            block[15] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[15] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[13] ^ block[8] ^ block[2] ^ block[0];
            block[0] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[0] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[14] ^ block[9] ^ block[3] ^ block[1];
            block[1] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[1] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[15] ^ block[10] ^ block[4] ^ block[2];
            block[2] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[2] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[0] ^ block[11] ^ block[5] ^ block[3];
            block[3] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[3] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[1] ^ block[12] ^ block[6] ^ block[4];
            block[4] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[4] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[2] ^ block[13] ^ block[7] ^ block[5];
            block[5] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[5] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[3] ^ block[14] ^ block[8] ^ block[6];
            block[6] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[6] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[4] ^ block[15] ^ block[9] ^ block[7];
            block[7] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[7] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[5] ^ block[0] ^ block[10] ^ block[8];
            block[8] = (temp << 1) | (temp >> 31);
            c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[8] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[6] ^ block[1] ^ block[11] ^ block[9];
            block[9] = (temp << 1) | (temp >> 31);
            c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[9] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[7] ^ block[2] ^ block[12] ^ block[10];
            block[10] = (temp << 1) | (temp >> 31);
            c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[10] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[8] ^ block[3] ^ block[13] ^ block[11];
            block[11] = (temp << 1) | (temp >> 31);
            c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[11] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[9] ^ block[4] ^ block[14] ^ block[12];
            block[12] = (temp << 1) | (temp >> 31);
            c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[12] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[10] ^ block[5] ^ block[15] ^ block[13];
            block[13] = (temp << 1) | (temp >> 31);
            c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[13] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[11] ^ block[6] ^ block[0] ^ block[14];
            block[14] = (temp << 1) | (temp >> 31);
            c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[14] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[12] ^ block[7] ^ block[1] ^ block[15];
            block[15] = (temp << 1) | (temp >> 31);
            c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[15] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[13] ^ block[8] ^ block[2] ^ block[0];
            block[0] = (temp << 1) | (temp >> 31);
            c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[0] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[14] ^ block[9] ^ block[3] ^ block[1];
            block[1] = (temp << 1) | (temp >> 31);
            c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[1] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[15] ^ block[10] ^ block[4] ^ block[2];
            block[2] = (temp << 1) | (temp >> 31);
            c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[2] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[0] ^ block[11] ^ block[5] ^ block[3];
            block[3] = (temp << 1) | (temp >> 31);
            c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[3] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[1] ^ block[12] ^ block[6] ^ block[4];
            block[4] = (temp << 1) | (temp >> 31);
            c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[4] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[2] ^ block[13] ^ block[7] ^ block[5];
            block[5] = (temp << 1) | (temp >> 31);
            c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[5] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[3] ^ block[14] ^ block[8] ^ block[6];
            block[6] = (temp << 1) | (temp >> 31);
            c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[6] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[4] ^ block[15] ^ block[9] ^ block[7];
            block[7] = (temp << 1) | (temp >> 31);
            c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[7] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[5] ^ block[0] ^ block[10] ^ block[8];
            block[8] = (temp << 1) | (temp >> 31);
            c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[8] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[6] ^ block[1] ^ block[11] ^ block[9];
            block[9] = (temp << 1) | (temp >> 31);
            c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[9] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[7] ^ block[2] ^ block[12] ^ block[10];
            block[10] = (temp << 1) | (temp >> 31);
            c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[10] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[8] ^ block[3] ^ block[13] ^ block[11];
            block[11] = (temp << 1) | (temp >> 31);
            c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[11] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[9] ^ block[4] ^ block[14] ^ block[12];
            block[12] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[12] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[10] ^ block[5] ^ block[15] ^ block[13];
            block[13] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[13] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[11] ^ block[6] ^ block[0] ^ block[14];
            block[14] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[14] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[12] ^ block[7] ^ block[1] ^ block[15];
            block[15] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[15] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[13] ^ block[8] ^ block[2] ^ block[0];
            block[0] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[0] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[14] ^ block[9] ^ block[3] ^ block[1];
            block[1] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[1] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[15] ^ block[10] ^ block[4] ^ block[2];
            block[2] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[2] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[0] ^ block[11] ^ block[5] ^ block[3];
            block[3] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[3] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[1] ^ block[12] ^ block[6] ^ block[4];
            block[4] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[4] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[2] ^ block[13] ^ block[7] ^ block[5];
            block[5] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[5] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[3] ^ block[14] ^ block[8] ^ block[6];
            block[6] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[6] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[4] ^ block[15] ^ block[9] ^ block[7];
            block[7] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[7] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[5] ^ block[0] ^ block[10] ^ block[8];
            block[8] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[8] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[6] ^ block[1] ^ block[11] ^ block[9];
            block[9] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[9] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[7] ^ block[2] ^ block[12] ^ block[10];
            block[10] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[10] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[8] ^ block[3] ^ block[13] ^ block[11];
            block[11] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[11] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[9] ^ block[4] ^ block[14] ^ block[12];
            block[12] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[12] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[10] ^ block[5] ^ block[15] ^ block[13];
            block[13] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[13] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[11] ^ block[6] ^ block[0] ^ block[14];
            block[14] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[14] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[12] ^ block[7] ^ block[1] ^ block[15];
            block[15] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[15] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            h0 += c0;
            h1 += c1;
            h2 += c2;
            h3 += c3;
            h4 += c4;
            block[0] = 0;
            block[1] = 0;
            block[2] = 0;
            block[3] = 0;
            block[4] = 0;
            block[5] = 0;
            block[6] = 0;
            block[7] = 0;
            block[8] = 0;
            block[9] = 0;
            block[10] = 0;
            block[11] = 0;
            block[12] = 0;
            block[13] = 0;
        }
        totalBytesRead <<= 3;
        block[15] = (uint)totalBytesRead;
        block[14] = (uint)(totalBytesRead >> 32);
        c0 = h0;
        c1 = h1;
        c2 = h2;
        c3 = h3;
        c4 = h4;
        c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[0] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[1] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[2] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[3] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[4] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[5] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[6] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[7] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[8] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[9] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[10] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[11] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[12] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[13] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[14] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[15] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[13] ^ block[8] ^ block[2] ^ block[0];
        block[0] = (temp << 1) | (temp >> 31);
        c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[0] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[14] ^ block[9] ^ block[3] ^ block[1];
        block[1] = (temp << 1) | (temp >> 31);
        c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[1] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[15] ^ block[10] ^ block[4] ^ block[2];
        block[2] = (temp << 1) | (temp >> 31);
        c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[2] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[0] ^ block[11] ^ block[5] ^ block[3];
        block[3] = (temp << 1) | (temp >> 31);
        c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[3] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[1] ^ block[12] ^ block[6] ^ block[4];
        block[4] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[4] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[2] ^ block[13] ^ block[7] ^ block[5];
        block[5] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[5] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[3] ^ block[14] ^ block[8] ^ block[6];
        block[6] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[6] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[4] ^ block[15] ^ block[9] ^ block[7];
        block[7] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[7] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[5] ^ block[0] ^ block[10] ^ block[8];
        block[8] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[8] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[6] ^ block[1] ^ block[11] ^ block[9];
        block[9] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[9] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[7] ^ block[2] ^ block[12] ^ block[10];
        block[10] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[10] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[8] ^ block[3] ^ block[13] ^ block[11];
        block[11] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[11] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[9] ^ block[4] ^ block[14] ^ block[12];
        block[12] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[12] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[10] ^ block[5] ^ block[15] ^ block[13];
        block[13] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[13] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[11] ^ block[6] ^ block[0] ^ block[14];
        block[14] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[14] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[12] ^ block[7] ^ block[1] ^ block[15];
        block[15] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[15] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[13] ^ block[8] ^ block[2] ^ block[0];
        block[0] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[0] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[14] ^ block[9] ^ block[3] ^ block[1];
        block[1] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[1] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[15] ^ block[10] ^ block[4] ^ block[2];
        block[2] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[2] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[0] ^ block[11] ^ block[5] ^ block[3];
        block[3] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[3] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[1] ^ block[12] ^ block[6] ^ block[4];
        block[4] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[4] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[2] ^ block[13] ^ block[7] ^ block[5];
        block[5] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[5] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[3] ^ block[14] ^ block[8] ^ block[6];
        block[6] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[6] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[4] ^ block[15] ^ block[9] ^ block[7];
        block[7] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[7] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[5] ^ block[0] ^ block[10] ^ block[8];
        block[8] = (temp << 1) | (temp >> 31);
        c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[8] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[6] ^ block[1] ^ block[11] ^ block[9];
        block[9] = (temp << 1) | (temp >> 31);
        c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[9] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[7] ^ block[2] ^ block[12] ^ block[10];
        block[10] = (temp << 1) | (temp >> 31);
        c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[10] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[8] ^ block[3] ^ block[13] ^ block[11];
        block[11] = (temp << 1) | (temp >> 31);
        c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[11] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[9] ^ block[4] ^ block[14] ^ block[12];
        block[12] = (temp << 1) | (temp >> 31);
        c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[12] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[10] ^ block[5] ^ block[15] ^ block[13];
        block[13] = (temp << 1) | (temp >> 31);
        c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[13] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[11] ^ block[6] ^ block[0] ^ block[14];
        block[14] = (temp << 1) | (temp >> 31);
        c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[14] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[12] ^ block[7] ^ block[1] ^ block[15];
        block[15] = (temp << 1) | (temp >> 31);
        c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[15] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[13] ^ block[8] ^ block[2] ^ block[0];
        block[0] = (temp << 1) | (temp >> 31);
        c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[0] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[14] ^ block[9] ^ block[3] ^ block[1];
        block[1] = (temp << 1) | (temp >> 31);
        c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[1] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[15] ^ block[10] ^ block[4] ^ block[2];
        block[2] = (temp << 1) | (temp >> 31);
        c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[2] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[0] ^ block[11] ^ block[5] ^ block[3];
        block[3] = (temp << 1) | (temp >> 31);
        c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[3] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[1] ^ block[12] ^ block[6] ^ block[4];
        block[4] = (temp << 1) | (temp >> 31);
        c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[4] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[2] ^ block[13] ^ block[7] ^ block[5];
        block[5] = (temp << 1) | (temp >> 31);
        c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[5] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[3] ^ block[14] ^ block[8] ^ block[6];
        block[6] = (temp << 1) | (temp >> 31);
        c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[6] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[4] ^ block[15] ^ block[9] ^ block[7];
        block[7] = (temp << 1) | (temp >> 31);
        c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[7] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[5] ^ block[0] ^ block[10] ^ block[8];
        block[8] = (temp << 1) | (temp >> 31);
        c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[8] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[6] ^ block[1] ^ block[11] ^ block[9];
        block[9] = (temp << 1) | (temp >> 31);
        c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[9] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[7] ^ block[2] ^ block[12] ^ block[10];
        block[10] = (temp << 1) | (temp >> 31);
        c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[10] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[8] ^ block[3] ^ block[13] ^ block[11];
        block[11] = (temp << 1) | (temp >> 31);
        c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[11] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[9] ^ block[4] ^ block[14] ^ block[12];
        block[12] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[12] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[10] ^ block[5] ^ block[15] ^ block[13];
        block[13] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[13] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[11] ^ block[6] ^ block[0] ^ block[14];
        block[14] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[14] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[12] ^ block[7] ^ block[1] ^ block[15];
        block[15] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[15] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[13] ^ block[8] ^ block[2] ^ block[0];
        block[0] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[0] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[14] ^ block[9] ^ block[3] ^ block[1];
        block[1] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[1] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[15] ^ block[10] ^ block[4] ^ block[2];
        block[2] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[2] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[0] ^ block[11] ^ block[5] ^ block[3];
        block[3] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[3] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[1] ^ block[12] ^ block[6] ^ block[4];
        block[4] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[4] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[2] ^ block[13] ^ block[7] ^ block[5];
        block[5] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[5] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[3] ^ block[14] ^ block[8] ^ block[6];
        block[6] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[6] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[4] ^ block[15] ^ block[9] ^ block[7];
        block[7] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[7] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[5] ^ block[0] ^ block[10] ^ block[8];
        block[8] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[8] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[6] ^ block[1] ^ block[11] ^ block[9];
        block[9] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[9] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[7] ^ block[2] ^ block[12] ^ block[10];
        block[10] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[10] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[8] ^ block[3] ^ block[13] ^ block[11];
        block[11] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[11] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[9] ^ block[4] ^ block[14] ^ block[12];
        block[12] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[12] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[10] ^ block[5] ^ block[15] ^ block[13];
        block[13] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[13] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[11] ^ block[6] ^ block[0] ^ block[14];
        block[14] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[14] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[12] ^ block[7] ^ block[1] ^ block[15];
        block[15] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[15] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        h0 += c0;
        h1 += c1;
        h2 += c2;
        h3 += c3;
        h4 += c4;
        hash[0] = (byte)((h0 >> 24) & 0xFF);
        hash[1] = (byte)((h0 >> 16) & 0xFF);
        hash[2] = (byte)((h0 >> 8) & 0xFF);
        hash[3] = (byte)(h0 & 0xFF);
        hash[4] = (byte)((h1 >> 24) & 0xFF);
        hash[5] = (byte)((h1 >> 16) & 0xFF);
        hash[6] = (byte)((h1 >> 8) & 0xFF);
        hash[7] = (byte)(h1 & 0xFF);
        hash[8] = (byte)((h2 >> 24) & 0xFF);
        hash[9] = (byte)((h2 >> 16) & 0xFF);
        hash[10] = (byte)((h2 >> 8) & 0xFF);
        hash[11] = (byte)(h2 & 0xFF);
        hash[12] = (byte)((h3 >> 24) & 0xFF);
        hash[13] = (byte)((h3 >> 16) & 0xFF);
        hash[14] = (byte)((h3 >> 8) & 0xFF);
        hash[15] = (byte)(h3 & 0xFF);
        hash[16] = (byte)((h4 >> 24) & 0xFF);
        hash[17] = (byte)((h4 >> 16) & 0xFF);
        hash[18] = (byte)((h4 >> 8) & 0xFF);
        hash[19] = (byte)(h4 & 0xFF);
    }
    /// <summary>Computes SHA-1 hash for specified stream and reports hashing progress.</summary>
    /// <param name="stream">Stream to compute the hash for; it will be read until end of stream is reached.</param>
    /// <param name="hash">Buffer that will receive SHA-1 hash value.</param>
    /// <param name="progress">Hashing progress in bytes, updated after every block is read.</param>
    public static void ComputeHash(Stream stream, Span<byte> hash, ref long progress)
    {
        uint h0 = 0x67452301, h1 = 0xEFCDAB89, h2 = 0x98BADCFE, h3 = 0x10325476, h4 = 0xC3D2E1F0;
        uint c0, c1, c2, c3, c4;
        uint temp;
        long totalBytesRead = 0;
        Span<byte> buffer = stackalloc byte[524288];
        Span<uint> block = stackalloc uint[16];
        int bytesRead;
        for (;;)
        {
            bytesRead = stream.Read(buffer);
            if (bytesRead == 0)
                break;
            totalBytesRead += bytesRead;
            for (int i = 0; i < bytesRead >> 6; i++)
            {
                var blockBuffer = buffer.Slice(i << 6, 64);
                block[0] = ((uint)blockBuffer[3] & 0xFF) | ((uint)blockBuffer[2] & 0xFF) << 8 | ((uint)blockBuffer[1] & 0xFF) << 16 | ((uint)blockBuffer[0] & 0xFF) << 24;
                block[1] = ((uint)blockBuffer[7] & 0xFF) | ((uint)blockBuffer[6] & 0xFF) << 8 | ((uint)blockBuffer[5] & 0xFF) << 16 | ((uint)blockBuffer[4] & 0xFF) << 24;
                block[2] = ((uint)blockBuffer[11] & 0xFF) | ((uint)blockBuffer[10] & 0xFF) << 8 | ((uint)blockBuffer[9] & 0xFF) << 16 | ((uint)blockBuffer[8] & 0xFF) << 24;
                block[3] = ((uint)blockBuffer[15] & 0xFF) | ((uint)blockBuffer[14] & 0xFF) << 8 | ((uint)blockBuffer[13] & 0xFF) << 16 | ((uint)blockBuffer[12] & 0xFF) << 24;
                block[4] = ((uint)blockBuffer[19] & 0xFF) | ((uint)blockBuffer[18] & 0xFF) << 8 | ((uint)blockBuffer[17] & 0xFF) << 16 | ((uint)blockBuffer[16] & 0xFF) << 24;
                block[5] = ((uint)blockBuffer[23] & 0xFF) | ((uint)blockBuffer[22] & 0xFF) << 8 | ((uint)blockBuffer[21] & 0xFF) << 16 | ((uint)blockBuffer[20] & 0xFF) << 24;
                block[6] = ((uint)blockBuffer[27] & 0xFF) | ((uint)blockBuffer[26] & 0xFF) << 8 | ((uint)blockBuffer[25] & 0xFF) << 16 | ((uint)blockBuffer[24] & 0xFF) << 24;
                block[7] = ((uint)blockBuffer[31] & 0xFF) | ((uint)blockBuffer[30] & 0xFF) << 8 | ((uint)blockBuffer[29] & 0xFF) << 16 | ((uint)blockBuffer[28] & 0xFF) << 24;
                block[8] = ((uint)blockBuffer[35] & 0xFF) | ((uint)blockBuffer[34] & 0xFF) << 8 | ((uint)blockBuffer[33] & 0xFF) << 16 | ((uint)blockBuffer[32] & 0xFF) << 24;
                block[9] = ((uint)blockBuffer[39] & 0xFF) | ((uint)blockBuffer[38] & 0xFF) << 8 | ((uint)blockBuffer[37] & 0xFF) << 16 | ((uint)blockBuffer[36] & 0xFF) << 24;
                block[10] = ((uint)blockBuffer[43] & 0xFF) | ((uint)blockBuffer[42] & 0xFF) << 8 | ((uint)blockBuffer[41] & 0xFF) << 16 | ((uint)blockBuffer[40] & 0xFF) << 24;
                block[11] = ((uint)blockBuffer[47] & 0xFF) | ((uint)blockBuffer[46] & 0xFF) << 8 | ((uint)blockBuffer[45] & 0xFF) << 16 | ((uint)blockBuffer[44] & 0xFF) << 24;
                block[12] = ((uint)blockBuffer[51] & 0xFF) | ((uint)blockBuffer[50] & 0xFF) << 8 | ((uint)blockBuffer[49] & 0xFF) << 16 | ((uint)blockBuffer[48] & 0xFF) << 24;
                block[13] = ((uint)blockBuffer[55] & 0xFF) | ((uint)blockBuffer[54] & 0xFF) << 8 | ((uint)blockBuffer[53] & 0xFF) << 16 | ((uint)blockBuffer[52] & 0xFF) << 24;
                block[14] = ((uint)blockBuffer[59] & 0xFF) | ((uint)blockBuffer[58] & 0xFF) << 8 | ((uint)blockBuffer[57] & 0xFF) << 16 | ((uint)blockBuffer[56] & 0xFF) << 24;
                block[15] = ((uint)blockBuffer[63] & 0xFF) | ((uint)blockBuffer[62] & 0xFF) << 8 | ((uint)blockBuffer[61] & 0xFF) << 16 | ((uint)blockBuffer[60] & 0xFF) << 24;
                c0 = h0;
                c1 = h1;
                c2 = h2;
                c3 = h3;
                c4 = h4;
                c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[0] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[1] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[2] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[3] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[4] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[5] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[6] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[7] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[8] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[9] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[10] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[11] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[12] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[13] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[14] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[15] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[13] ^ block[8] ^ block[2] ^ block[0];
                block[0] = (temp << 1) | (temp >> 31);
                c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[0] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[14] ^ block[9] ^ block[3] ^ block[1];
                block[1] = (temp << 1) | (temp >> 31);
                c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[1] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[15] ^ block[10] ^ block[4] ^ block[2];
                block[2] = (temp << 1) | (temp >> 31);
                c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[2] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[0] ^ block[11] ^ block[5] ^ block[3];
                block[3] = (temp << 1) | (temp >> 31);
                c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[3] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[1] ^ block[12] ^ block[6] ^ block[4];
                block[4] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[4] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[2] ^ block[13] ^ block[7] ^ block[5];
                block[5] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[5] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[3] ^ block[14] ^ block[8] ^ block[6];
                block[6] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[6] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[4] ^ block[15] ^ block[9] ^ block[7];
                block[7] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[7] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[5] ^ block[0] ^ block[10] ^ block[8];
                block[8] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[8] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[6] ^ block[1] ^ block[11] ^ block[9];
                block[9] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[9] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[7] ^ block[2] ^ block[12] ^ block[10];
                block[10] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[10] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[8] ^ block[3] ^ block[13] ^ block[11];
                block[11] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[11] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[9] ^ block[4] ^ block[14] ^ block[12];
                block[12] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[12] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[10] ^ block[5] ^ block[15] ^ block[13];
                block[13] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[13] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[11] ^ block[6] ^ block[0] ^ block[14];
                block[14] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[14] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[12] ^ block[7] ^ block[1] ^ block[15];
                block[15] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[15] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[13] ^ block[8] ^ block[2] ^ block[0];
                block[0] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[0] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[14] ^ block[9] ^ block[3] ^ block[1];
                block[1] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[1] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[15] ^ block[10] ^ block[4] ^ block[2];
                block[2] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[2] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[0] ^ block[11] ^ block[5] ^ block[3];
                block[3] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[3] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[1] ^ block[12] ^ block[6] ^ block[4];
                block[4] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[4] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[2] ^ block[13] ^ block[7] ^ block[5];
                block[5] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[5] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[3] ^ block[14] ^ block[8] ^ block[6];
                block[6] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[6] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[4] ^ block[15] ^ block[9] ^ block[7];
                block[7] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[7] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[5] ^ block[0] ^ block[10] ^ block[8];
                block[8] = (temp << 1) | (temp >> 31);
                c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[8] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[6] ^ block[1] ^ block[11] ^ block[9];
                block[9] = (temp << 1) | (temp >> 31);
                c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[9] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[7] ^ block[2] ^ block[12] ^ block[10];
                block[10] = (temp << 1) | (temp >> 31);
                c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[10] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[8] ^ block[3] ^ block[13] ^ block[11];
                block[11] = (temp << 1) | (temp >> 31);
                c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[11] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[9] ^ block[4] ^ block[14] ^ block[12];
                block[12] = (temp << 1) | (temp >> 31);
                c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[12] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[10] ^ block[5] ^ block[15] ^ block[13];
                block[13] = (temp << 1) | (temp >> 31);
                c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[13] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[11] ^ block[6] ^ block[0] ^ block[14];
                block[14] = (temp << 1) | (temp >> 31);
                c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[14] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[12] ^ block[7] ^ block[1] ^ block[15];
                block[15] = (temp << 1) | (temp >> 31);
                c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[15] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[13] ^ block[8] ^ block[2] ^ block[0];
                block[0] = (temp << 1) | (temp >> 31);
                c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[0] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[14] ^ block[9] ^ block[3] ^ block[1];
                block[1] = (temp << 1) | (temp >> 31);
                c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[1] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[15] ^ block[10] ^ block[4] ^ block[2];
                block[2] = (temp << 1) | (temp >> 31);
                c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[2] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[0] ^ block[11] ^ block[5] ^ block[3];
                block[3] = (temp << 1) | (temp >> 31);
                c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[3] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[1] ^ block[12] ^ block[6] ^ block[4];
                block[4] = (temp << 1) | (temp >> 31);
                c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[4] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[2] ^ block[13] ^ block[7] ^ block[5];
                block[5] = (temp << 1) | (temp >> 31);
                c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[5] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[3] ^ block[14] ^ block[8] ^ block[6];
                block[6] = (temp << 1) | (temp >> 31);
                c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[6] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[4] ^ block[15] ^ block[9] ^ block[7];
                block[7] = (temp << 1) | (temp >> 31);
                c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[7] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[5] ^ block[0] ^ block[10] ^ block[8];
                block[8] = (temp << 1) | (temp >> 31);
                c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[8] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[6] ^ block[1] ^ block[11] ^ block[9];
                block[9] = (temp << 1) | (temp >> 31);
                c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[9] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[7] ^ block[2] ^ block[12] ^ block[10];
                block[10] = (temp << 1) | (temp >> 31);
                c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[10] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[8] ^ block[3] ^ block[13] ^ block[11];
                block[11] = (temp << 1) | (temp >> 31);
                c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[11] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[9] ^ block[4] ^ block[14] ^ block[12];
                block[12] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[12] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[10] ^ block[5] ^ block[15] ^ block[13];
                block[13] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[13] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[11] ^ block[6] ^ block[0] ^ block[14];
                block[14] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[14] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[12] ^ block[7] ^ block[1] ^ block[15];
                block[15] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[15] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[13] ^ block[8] ^ block[2] ^ block[0];
                block[0] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[0] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[14] ^ block[9] ^ block[3] ^ block[1];
                block[1] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[1] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[15] ^ block[10] ^ block[4] ^ block[2];
                block[2] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[2] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[0] ^ block[11] ^ block[5] ^ block[3];
                block[3] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[3] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[1] ^ block[12] ^ block[6] ^ block[4];
                block[4] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[4] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[2] ^ block[13] ^ block[7] ^ block[5];
                block[5] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[5] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[3] ^ block[14] ^ block[8] ^ block[6];
                block[6] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[6] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[4] ^ block[15] ^ block[9] ^ block[7];
                block[7] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[7] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[5] ^ block[0] ^ block[10] ^ block[8];
                block[8] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[8] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[6] ^ block[1] ^ block[11] ^ block[9];
                block[9] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[9] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[7] ^ block[2] ^ block[12] ^ block[10];
                block[10] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[10] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                temp = block[8] ^ block[3] ^ block[13] ^ block[11];
                block[11] = (temp << 1) | (temp >> 31);
                c4 += (c1 ^ c2 ^ c3) + block[11] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
                c1 = (c1 << 30) | (c1 >> 2);
                temp = block[9] ^ block[4] ^ block[14] ^ block[12];
                block[12] = (temp << 1) | (temp >> 31);
                c3 += (c0 ^ c1 ^ c2) + block[12] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
                c0 = (c0 << 30) | (c0 >> 2);
                temp = block[10] ^ block[5] ^ block[15] ^ block[13];
                block[13] = (temp << 1) | (temp >> 31);
                c2 += (c4 ^ c0 ^ c1) + block[13] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
                c4 = (c4 << 30) | (c4 >> 2);
                temp = block[11] ^ block[6] ^ block[0] ^ block[14];
                block[14] = (temp << 1) | (temp >> 31);
                c1 += (c3 ^ c4 ^ c0) + block[14] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
                c3 = (c3 << 30) | (c3 >> 2);
                temp = block[12] ^ block[7] ^ block[1] ^ block[15];
                block[15] = (temp << 1) | (temp >> 31);
                c0 += (c2 ^ c3 ^ c4) + block[15] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
                c2 = (c2 << 30) | (c2 >> 2);
                h0 += c0;
                h1 += c1;
                h2 += c2;
                h3 += c3;
                h4 += c4;
                progress += 64;
            }
            int remainder = bytesRead & 63;
            if (remainder > 0)
            {
                progress += remainder;
                buffer = buffer[(bytesRead - remainder)..];
                bytesRead = remainder;
                break;
            }
        }
        buffer[bytesRead++] = 0x80;
        bool transform = bytesRead > 56;
        while (bytesRead < 64)
            buffer[bytesRead++] = 0;
        block[0] = ((uint)buffer[3] & 0xFF) | ((uint)buffer[2] & 0xFF) << 8 | ((uint)buffer[1] & 0xFF) << 16 | ((uint)buffer[0] & 0xFF) << 24;
        block[1] = ((uint)buffer[7] & 0xFF) | ((uint)buffer[6] & 0xFF) << 8 | ((uint)buffer[5] & 0xFF) << 16 | ((uint)buffer[4] & 0xFF) << 24;
        block[2] = ((uint)buffer[11] & 0xFF) | ((uint)buffer[10] & 0xFF) << 8 | ((uint)buffer[9] & 0xFF) << 16 | ((uint)buffer[8] & 0xFF) << 24;
        block[3] = ((uint)buffer[15] & 0xFF) | ((uint)buffer[14] & 0xFF) << 8 | ((uint)buffer[13] & 0xFF) << 16 | ((uint)buffer[12] & 0xFF) << 24;
        block[4] = ((uint)buffer[19] & 0xFF) | ((uint)buffer[18] & 0xFF) << 8 | ((uint)buffer[17] & 0xFF) << 16 | ((uint)buffer[16] & 0xFF) << 24;
        block[5] = ((uint)buffer[23] & 0xFF) | ((uint)buffer[22] & 0xFF) << 8 | ((uint)buffer[21] & 0xFF) << 16 | ((uint)buffer[20] & 0xFF) << 24;
        block[6] = ((uint)buffer[27] & 0xFF) | ((uint)buffer[26] & 0xFF) << 8 | ((uint)buffer[25] & 0xFF) << 16 | ((uint)buffer[24] & 0xFF) << 24;
        block[7] = ((uint)buffer[31] & 0xFF) | ((uint)buffer[30] & 0xFF) << 8 | ((uint)buffer[29] & 0xFF) << 16 | ((uint)buffer[28] & 0xFF) << 24;
        block[8] = ((uint)buffer[35] & 0xFF) | ((uint)buffer[34] & 0xFF) << 8 | ((uint)buffer[33] & 0xFF) << 16 | ((uint)buffer[32] & 0xFF) << 24;
        block[9] = ((uint)buffer[39] & 0xFF) | ((uint)buffer[38] & 0xFF) << 8 | ((uint)buffer[37] & 0xFF) << 16 | ((uint)buffer[36] & 0xFF) << 24;
        block[10] = ((uint)buffer[43] & 0xFF) | ((uint)buffer[42] & 0xFF) << 8 | ((uint)buffer[41] & 0xFF) << 16 | ((uint)buffer[40] & 0xFF) << 24;
        block[11] = ((uint)buffer[47] & 0xFF) | ((uint)buffer[46] & 0xFF) << 8 | ((uint)buffer[45] & 0xFF) << 16 | ((uint)buffer[44] & 0xFF) << 24;
        block[12] = ((uint)buffer[51] & 0xFF) | ((uint)buffer[50] & 0xFF) << 8 | ((uint)buffer[49] & 0xFF) << 16 | ((uint)buffer[48] & 0xFF) << 24;
        block[13] = ((uint)buffer[55] & 0xFF) | ((uint)buffer[54] & 0xFF) << 8 | ((uint)buffer[53] & 0xFF) << 16 | ((uint)buffer[52] & 0xFF) << 24;
        block[14] = ((uint)buffer[59] & 0xFF) | ((uint)buffer[58] & 0xFF) << 8 | ((uint)buffer[57] & 0xFF) << 16 | ((uint)buffer[56] & 0xFF) << 24;
        block[15] = ((uint)buffer[63] & 0xFF) | ((uint)buffer[62] & 0xFF) << 8 | ((uint)buffer[61] & 0xFF) << 16 | ((uint)buffer[60] & 0xFF) << 24;
        if (transform)
        {
            c0 = h0;
            c1 = h1;
            c2 = h2;
            c3 = h3;
            c4 = h4;
            c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[0] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[1] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[2] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[3] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[4] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[5] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[6] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[7] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[8] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[9] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[10] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[11] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[12] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[13] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[14] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[15] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[13] ^ block[8] ^ block[2] ^ block[0];
            block[0] = (temp << 1) | (temp >> 31);
            c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[0] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[14] ^ block[9] ^ block[3] ^ block[1];
            block[1] = (temp << 1) | (temp >> 31);
            c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[1] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[15] ^ block[10] ^ block[4] ^ block[2];
            block[2] = (temp << 1) | (temp >> 31);
            c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[2] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[0] ^ block[11] ^ block[5] ^ block[3];
            block[3] = (temp << 1) | (temp >> 31);
            c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[3] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[1] ^ block[12] ^ block[6] ^ block[4];
            block[4] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[4] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[2] ^ block[13] ^ block[7] ^ block[5];
            block[5] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[5] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[3] ^ block[14] ^ block[8] ^ block[6];
            block[6] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[6] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[4] ^ block[15] ^ block[9] ^ block[7];
            block[7] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[7] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[5] ^ block[0] ^ block[10] ^ block[8];
            block[8] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[8] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[6] ^ block[1] ^ block[11] ^ block[9];
            block[9] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[9] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[7] ^ block[2] ^ block[12] ^ block[10];
            block[10] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[10] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[8] ^ block[3] ^ block[13] ^ block[11];
            block[11] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[11] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[9] ^ block[4] ^ block[14] ^ block[12];
            block[12] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[12] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[10] ^ block[5] ^ block[15] ^ block[13];
            block[13] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[13] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[11] ^ block[6] ^ block[0] ^ block[14];
            block[14] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[14] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[12] ^ block[7] ^ block[1] ^ block[15];
            block[15] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[15] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[13] ^ block[8] ^ block[2] ^ block[0];
            block[0] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[0] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[14] ^ block[9] ^ block[3] ^ block[1];
            block[1] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[1] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[15] ^ block[10] ^ block[4] ^ block[2];
            block[2] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[2] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[0] ^ block[11] ^ block[5] ^ block[3];
            block[3] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[3] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[1] ^ block[12] ^ block[6] ^ block[4];
            block[4] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[4] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[2] ^ block[13] ^ block[7] ^ block[5];
            block[5] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[5] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[3] ^ block[14] ^ block[8] ^ block[6];
            block[6] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[6] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[4] ^ block[15] ^ block[9] ^ block[7];
            block[7] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[7] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[5] ^ block[0] ^ block[10] ^ block[8];
            block[8] = (temp << 1) | (temp >> 31);
            c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[8] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[6] ^ block[1] ^ block[11] ^ block[9];
            block[9] = (temp << 1) | (temp >> 31);
            c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[9] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[7] ^ block[2] ^ block[12] ^ block[10];
            block[10] = (temp << 1) | (temp >> 31);
            c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[10] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[8] ^ block[3] ^ block[13] ^ block[11];
            block[11] = (temp << 1) | (temp >> 31);
            c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[11] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[9] ^ block[4] ^ block[14] ^ block[12];
            block[12] = (temp << 1) | (temp >> 31);
            c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[12] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[10] ^ block[5] ^ block[15] ^ block[13];
            block[13] = (temp << 1) | (temp >> 31);
            c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[13] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[11] ^ block[6] ^ block[0] ^ block[14];
            block[14] = (temp << 1) | (temp >> 31);
            c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[14] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[12] ^ block[7] ^ block[1] ^ block[15];
            block[15] = (temp << 1) | (temp >> 31);
            c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[15] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[13] ^ block[8] ^ block[2] ^ block[0];
            block[0] = (temp << 1) | (temp >> 31);
            c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[0] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[14] ^ block[9] ^ block[3] ^ block[1];
            block[1] = (temp << 1) | (temp >> 31);
            c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[1] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[15] ^ block[10] ^ block[4] ^ block[2];
            block[2] = (temp << 1) | (temp >> 31);
            c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[2] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[0] ^ block[11] ^ block[5] ^ block[3];
            block[3] = (temp << 1) | (temp >> 31);
            c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[3] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[1] ^ block[12] ^ block[6] ^ block[4];
            block[4] = (temp << 1) | (temp >> 31);
            c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[4] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[2] ^ block[13] ^ block[7] ^ block[5];
            block[5] = (temp << 1) | (temp >> 31);
            c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[5] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[3] ^ block[14] ^ block[8] ^ block[6];
            block[6] = (temp << 1) | (temp >> 31);
            c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[6] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[4] ^ block[15] ^ block[9] ^ block[7];
            block[7] = (temp << 1) | (temp >> 31);
            c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[7] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[5] ^ block[0] ^ block[10] ^ block[8];
            block[8] = (temp << 1) | (temp >> 31);
            c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[8] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[6] ^ block[1] ^ block[11] ^ block[9];
            block[9] = (temp << 1) | (temp >> 31);
            c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[9] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[7] ^ block[2] ^ block[12] ^ block[10];
            block[10] = (temp << 1) | (temp >> 31);
            c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[10] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[8] ^ block[3] ^ block[13] ^ block[11];
            block[11] = (temp << 1) | (temp >> 31);
            c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[11] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[9] ^ block[4] ^ block[14] ^ block[12];
            block[12] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[12] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[10] ^ block[5] ^ block[15] ^ block[13];
            block[13] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[13] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[11] ^ block[6] ^ block[0] ^ block[14];
            block[14] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[14] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[12] ^ block[7] ^ block[1] ^ block[15];
            block[15] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[15] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[13] ^ block[8] ^ block[2] ^ block[0];
            block[0] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[0] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[14] ^ block[9] ^ block[3] ^ block[1];
            block[1] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[1] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[15] ^ block[10] ^ block[4] ^ block[2];
            block[2] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[2] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[0] ^ block[11] ^ block[5] ^ block[3];
            block[3] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[3] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[1] ^ block[12] ^ block[6] ^ block[4];
            block[4] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[4] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[2] ^ block[13] ^ block[7] ^ block[5];
            block[5] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[5] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[3] ^ block[14] ^ block[8] ^ block[6];
            block[6] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[6] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[4] ^ block[15] ^ block[9] ^ block[7];
            block[7] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[7] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[5] ^ block[0] ^ block[10] ^ block[8];
            block[8] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[8] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[6] ^ block[1] ^ block[11] ^ block[9];
            block[9] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[9] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[7] ^ block[2] ^ block[12] ^ block[10];
            block[10] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[10] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            temp = block[8] ^ block[3] ^ block[13] ^ block[11];
            block[11] = (temp << 1) | (temp >> 31);
            c4 += (c1 ^ c2 ^ c3) + block[11] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
            c1 = (c1 << 30) | (c1 >> 2);
            temp = block[9] ^ block[4] ^ block[14] ^ block[12];
            block[12] = (temp << 1) | (temp >> 31);
            c3 += (c0 ^ c1 ^ c2) + block[12] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
            c0 = (c0 << 30) | (c0 >> 2);
            temp = block[10] ^ block[5] ^ block[15] ^ block[13];
            block[13] = (temp << 1) | (temp >> 31);
            c2 += (c4 ^ c0 ^ c1) + block[13] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
            c4 = (c4 << 30) | (c4 >> 2);
            temp = block[11] ^ block[6] ^ block[0] ^ block[14];
            block[14] = (temp << 1) | (temp >> 31);
            c1 += (c3 ^ c4 ^ c0) + block[14] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
            c3 = (c3 << 30) | (c3 >> 2);
            temp = block[12] ^ block[7] ^ block[1] ^ block[15];
            block[15] = (temp << 1) | (temp >> 31);
            c0 += (c2 ^ c3 ^ c4) + block[15] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
            c2 = (c2 << 30) | (c2 >> 2);
            h0 += c0;
            h1 += c1;
            h2 += c2;
            h3 += c3;
            h4 += c4;
            block[0] = 0;
            block[1] = 0;
            block[2] = 0;
            block[3] = 0;
            block[4] = 0;
            block[5] = 0;
            block[6] = 0;
            block[7] = 0;
            block[8] = 0;
            block[9] = 0;
            block[10] = 0;
            block[11] = 0;
            block[12] = 0;
            block[13] = 0;
        }
        totalBytesRead <<= 3;
        block[15] = (uint)totalBytesRead;
        block[14] = (uint)(totalBytesRead >> 32);
        c0 = h0;
        c1 = h1;
        c2 = h2;
        c3 = h3;
        c4 = h4;
        c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[0] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[1] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[2] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[3] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[4] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[5] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[6] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[7] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[8] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[9] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[10] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[11] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[12] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[13] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[14] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        c4 += ((c1 & (c2 ^ c3)) ^ c3) + block[15] + 0x5A827999 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[13] ^ block[8] ^ block[2] ^ block[0];
        block[0] = (temp << 1) | (temp >> 31);
        c3 += ((c0 & (c1 ^ c2)) ^ c2) + block[0] + 0x5A827999 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[14] ^ block[9] ^ block[3] ^ block[1];
        block[1] = (temp << 1) | (temp >> 31);
        c2 += ((c4 & (c0 ^ c1)) ^ c1) + block[1] + 0x5A827999 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[15] ^ block[10] ^ block[4] ^ block[2];
        block[2] = (temp << 1) | (temp >> 31);
        c1 += ((c3 & (c4 ^ c0)) ^ c0) + block[2] + 0x5A827999 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[0] ^ block[11] ^ block[5] ^ block[3];
        block[3] = (temp << 1) | (temp >> 31);
        c0 += ((c2 & (c3 ^ c4)) ^ c4) + block[3] + 0x5A827999 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[1] ^ block[12] ^ block[6] ^ block[4];
        block[4] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[4] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[2] ^ block[13] ^ block[7] ^ block[5];
        block[5] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[5] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[3] ^ block[14] ^ block[8] ^ block[6];
        block[6] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[6] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[4] ^ block[15] ^ block[9] ^ block[7];
        block[7] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[7] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[5] ^ block[0] ^ block[10] ^ block[8];
        block[8] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[8] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[6] ^ block[1] ^ block[11] ^ block[9];
        block[9] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[9] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[7] ^ block[2] ^ block[12] ^ block[10];
        block[10] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[10] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[8] ^ block[3] ^ block[13] ^ block[11];
        block[11] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[11] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[9] ^ block[4] ^ block[14] ^ block[12];
        block[12] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[12] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[10] ^ block[5] ^ block[15] ^ block[13];
        block[13] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[13] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[11] ^ block[6] ^ block[0] ^ block[14];
        block[14] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[14] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[12] ^ block[7] ^ block[1] ^ block[15];
        block[15] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[15] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[13] ^ block[8] ^ block[2] ^ block[0];
        block[0] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[0] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[14] ^ block[9] ^ block[3] ^ block[1];
        block[1] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[1] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[15] ^ block[10] ^ block[4] ^ block[2];
        block[2] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[2] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[0] ^ block[11] ^ block[5] ^ block[3];
        block[3] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[3] + 0x6ED9EBA1 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[1] ^ block[12] ^ block[6] ^ block[4];
        block[4] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[4] + 0x6ED9EBA1 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[2] ^ block[13] ^ block[7] ^ block[5];
        block[5] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[5] + 0x6ED9EBA1 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[3] ^ block[14] ^ block[8] ^ block[6];
        block[6] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[6] + 0x6ED9EBA1 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[4] ^ block[15] ^ block[9] ^ block[7];
        block[7] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[7] + 0x6ED9EBA1 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[5] ^ block[0] ^ block[10] ^ block[8];
        block[8] = (temp << 1) | (temp >> 31);
        c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[8] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[6] ^ block[1] ^ block[11] ^ block[9];
        block[9] = (temp << 1) | (temp >> 31);
        c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[9] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[7] ^ block[2] ^ block[12] ^ block[10];
        block[10] = (temp << 1) | (temp >> 31);
        c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[10] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[8] ^ block[3] ^ block[13] ^ block[11];
        block[11] = (temp << 1) | (temp >> 31);
        c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[11] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[9] ^ block[4] ^ block[14] ^ block[12];
        block[12] = (temp << 1) | (temp >> 31);
        c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[12] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[10] ^ block[5] ^ block[15] ^ block[13];
        block[13] = (temp << 1) | (temp >> 31);
        c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[13] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[11] ^ block[6] ^ block[0] ^ block[14];
        block[14] = (temp << 1) | (temp >> 31);
        c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[14] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[12] ^ block[7] ^ block[1] ^ block[15];
        block[15] = (temp << 1) | (temp >> 31);
        c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[15] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[13] ^ block[8] ^ block[2] ^ block[0];
        block[0] = (temp << 1) | (temp >> 31);
        c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[0] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[14] ^ block[9] ^ block[3] ^ block[1];
        block[1] = (temp << 1) | (temp >> 31);
        c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[1] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[15] ^ block[10] ^ block[4] ^ block[2];
        block[2] = (temp << 1) | (temp >> 31);
        c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[2] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[0] ^ block[11] ^ block[5] ^ block[3];
        block[3] = (temp << 1) | (temp >> 31);
        c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[3] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[1] ^ block[12] ^ block[6] ^ block[4];
        block[4] = (temp << 1) | (temp >> 31);
        c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[4] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[2] ^ block[13] ^ block[7] ^ block[5];
        block[5] = (temp << 1) | (temp >> 31);
        c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[5] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[3] ^ block[14] ^ block[8] ^ block[6];
        block[6] = (temp << 1) | (temp >> 31);
        c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[6] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[4] ^ block[15] ^ block[9] ^ block[7];
        block[7] = (temp << 1) | (temp >> 31);
        c4 += (((c1 | c2) & c3) | (c1 & c2)) + block[7] + 0x8F1BBCDC + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[5] ^ block[0] ^ block[10] ^ block[8];
        block[8] = (temp << 1) | (temp >> 31);
        c3 += (((c0 | c1) & c2) | (c0 & c1)) + block[8] + 0x8F1BBCDC + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[6] ^ block[1] ^ block[11] ^ block[9];
        block[9] = (temp << 1) | (temp >> 31);
        c2 += (((c4 | c0) & c1) | (c4 & c0)) + block[9] + 0x8F1BBCDC + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[7] ^ block[2] ^ block[12] ^ block[10];
        block[10] = (temp << 1) | (temp >> 31);
        c1 += (((c3 | c4) & c0) | (c3 & c4)) + block[10] + 0x8F1BBCDC + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[8] ^ block[3] ^ block[13] ^ block[11];
        block[11] = (temp << 1) | (temp >> 31);
        c0 += (((c2 | c3) & c4) | (c2 & c3)) + block[11] + 0x8F1BBCDC + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[9] ^ block[4] ^ block[14] ^ block[12];
        block[12] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[12] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[10] ^ block[5] ^ block[15] ^ block[13];
        block[13] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[13] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[11] ^ block[6] ^ block[0] ^ block[14];
        block[14] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[14] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[12] ^ block[7] ^ block[1] ^ block[15];
        block[15] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[15] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[13] ^ block[8] ^ block[2] ^ block[0];
        block[0] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[0] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[14] ^ block[9] ^ block[3] ^ block[1];
        block[1] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[1] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[15] ^ block[10] ^ block[4] ^ block[2];
        block[2] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[2] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[0] ^ block[11] ^ block[5] ^ block[3];
        block[3] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[3] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[1] ^ block[12] ^ block[6] ^ block[4];
        block[4] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[4] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[2] ^ block[13] ^ block[7] ^ block[5];
        block[5] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[5] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[3] ^ block[14] ^ block[8] ^ block[6];
        block[6] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[6] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[4] ^ block[15] ^ block[9] ^ block[7];
        block[7] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[7] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[5] ^ block[0] ^ block[10] ^ block[8];
        block[8] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[8] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[6] ^ block[1] ^ block[11] ^ block[9];
        block[9] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[9] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[7] ^ block[2] ^ block[12] ^ block[10];
        block[10] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[10] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        temp = block[8] ^ block[3] ^ block[13] ^ block[11];
        block[11] = (temp << 1) | (temp >> 31);
        c4 += (c1 ^ c2 ^ c3) + block[11] + 0xCA62C1D6 + ((c0 << 5) | (c0 >> 27));
        c1 = (c1 << 30) | (c1 >> 2);
        temp = block[9] ^ block[4] ^ block[14] ^ block[12];
        block[12] = (temp << 1) | (temp >> 31);
        c3 += (c0 ^ c1 ^ c2) + block[12] + 0xCA62C1D6 + ((c4 << 5) | (c4 >> 27));
        c0 = (c0 << 30) | (c0 >> 2);
        temp = block[10] ^ block[5] ^ block[15] ^ block[13];
        block[13] = (temp << 1) | (temp >> 31);
        c2 += (c4 ^ c0 ^ c1) + block[13] + 0xCA62C1D6 + ((c3 << 5) | (c3 >> 27));
        c4 = (c4 << 30) | (c4 >> 2);
        temp = block[11] ^ block[6] ^ block[0] ^ block[14];
        block[14] = (temp << 1) | (temp >> 31);
        c1 += (c3 ^ c4 ^ c0) + block[14] + 0xCA62C1D6 + ((c2 << 5) | (c2 >> 27));
        c3 = (c3 << 30) | (c3 >> 2);
        temp = block[12] ^ block[7] ^ block[1] ^ block[15];
        block[15] = (temp << 1) | (temp >> 31);
        c0 += (c2 ^ c3 ^ c4) + block[15] + 0xCA62C1D6 + ((c1 << 5) | (c1 >> 27));
        c2 = (c2 << 30) | (c2 >> 2);
        h0 += c0;
        h1 += c1;
        h2 += c2;
        h3 += c3;
        h4 += c4;
        hash[0] = (byte)((h0 >> 24) & 0xFF);
        hash[1] = (byte)((h0 >> 16) & 0xFF);
        hash[2] = (byte)((h0 >> 8) & 0xFF);
        hash[3] = (byte)(h0 & 0xFF);
        hash[4] = (byte)((h1 >> 24) & 0xFF);
        hash[5] = (byte)((h1 >> 16) & 0xFF);
        hash[6] = (byte)((h1 >> 8) & 0xFF);
        hash[7] = (byte)(h1 & 0xFF);
        hash[8] = (byte)((h2 >> 24) & 0xFF);
        hash[9] = (byte)((h2 >> 16) & 0xFF);
        hash[10] = (byte)((h2 >> 8) & 0xFF);
        hash[11] = (byte)(h2 & 0xFF);
        hash[12] = (byte)((h3 >> 24) & 0xFF);
        hash[13] = (byte)((h3 >> 16) & 0xFF);
        hash[14] = (byte)((h3 >> 8) & 0xFF);
        hash[15] = (byte)(h3 & 0xFF);
        hash[16] = (byte)((h4 >> 24) & 0xFF);
        hash[17] = (byte)((h4 >> 16) & 0xFF);
        hash[18] = (byte)((h4 >> 8) & 0xFF);
        hash[19] = (byte)(h4 & 0xFF);
    }
}